# Story 1.2.5: Validate Session Configuration Loading

## Status
Draft

## Story
**As a** Phase 0 developer,
**I want** to test that session configuration loads without errors in Claude Code,
**so that** Phase 1 can start autonomously without configuration failures blocking progress.

## Acceptance Criteria

1. Attempt to load `claude-session-config.yaml` in Claude Code environment (manual test or via script if validator available)
2. YAML parsing successful: no syntax errors, all required sections present (context_files, credentials, checkpoint_triggers, success_criteria, workflow_reference)
3. Context file paths validated: all referenced files either exist or are documented as "Phase 1 will create"
4. Environment variable references validated: placeholders follow correct syntax `${VAR_NAME}`, no hardcoded secrets present (security scan confirms)
5. Checkpoint trigger logic validated: time intervals reasonable (30min not 30sec), error handling appropriate
6. If loading fails: document specific errors in `docs/phase-0-validation-log.md`, fix configuration, re-test until successful load
7. Successful configuration loading documented in validation log with timestamp and any warnings/notes
8. Add negative test cases: Test with missing environment variable (expect graceful error), Test with malformed YAML (expect parse error with line number), Test with invalid file path (expect clear file-not-found error)

## Tasks / Subtasks

- [ ] Prepare validation environment (Prerequisites)
  - [ ] Ensure Claude Code environment ready
  - [ ] Review session config file location
  - [ ] Prepare validation log for results
- [ ] Attempt configuration loading (AC: 1)
  - [ ] Load `Landing Pages Automation/claude-session-config.yaml`
  - [ ] Use manual test or validation script
  - [ ] Capture loading results
- [ ] Validate YAML parsing (AC: 2)
  - [ ] Check for syntax errors
  - [ ] Verify all required sections present:
    - context_files
    - credentials
    - checkpoint_triggers
    - success_criteria
    - workflow_reference
  - [ ] Document parsing results
- [ ] Validate context file paths (AC: 3)
  - [ ] Check each referenced file exists OR is marked "Phase 1 will create"
  - [ ] Verify file paths are correct
  - [ ] Document any missing files with explanation
- [ ] Validate environment variable references (AC: 4)
  - [ ] Check all variables use correct syntax: `${VAR_NAME}`
  - [ ] Run security scan for hardcoded secrets
  - [ ] Verify no actual API keys or tokens present
  - [ ] Document validation results
- [ ] Validate checkpoint trigger logic (AC: 5)
  - [ ] Review time-based intervals (should be 30min, not 30sec)
  - [ ] Review error handling triggers (appropriate conditions)
  - [ ] Review phase-completion triggers (after each stage)
  - [ ] Document any logic issues
- [ ] Handle loading failures if any (AC: 6)
  - [ ] Document specific errors in `docs/phase-0-validation-log.md`
  - [ ] Fix configuration issues
  - [ ] Re-test until successful load
  - [ ] Track all iterations and fixes
- [ ] Document successful loading (AC: 7)
  - [ ] Update `docs/phase-0-validation-log.md`
  - [ ] Include timestamp of successful load
  - [ ] Note any warnings (non-blocking issues)
  - [ ] Document configuration readiness
- [ ] Execute negative test cases (AC: 8)
  - [ ] Test 1: Remove environment variable (expect graceful error)
    - Remove `TAVILY_API_KEY` temporarily
    - Verify clear error message
    - Restore variable
  - [ ] Test 2: Introduce YAML syntax error (expect parse error with line number)
    - Add malformed YAML temporarily
    - Verify error indicates line number
    - Fix YAML
  - [ ] Test 3: Reference invalid file path (expect file-not-found error)
    - Add non-existent file path temporarily
    - Verify clear file-not-found message
    - Remove invalid path
  - [ ] Document all negative test results
- [ ] Commit validation results to Git
  - [ ] Review validation log completeness
  - [ ] Stage validation log with `git add`
  - [ ] Create commit with message: `docs: validate session configuration loading for Phase 1 readiness`
  - [ ] Verify commit was created successfully

## Dev Notes

### Context
Fifth story in Phase 0 Epic 2. Validates that session configuration from Stories 2.3 and 2.4 loads correctly in Claude Code environment. This is the final validation before Phase 1 handoff.

### Key Information
- **Config Location:** `Landing Pages Automation/claude-session-config.yaml`
- **Validation Log:** `docs/phase-0-validation-log.md` (append results)
- **Validation Types:**
  1. YAML syntax validation
  2. Structure completeness validation
  3. File path validation
  4. Environment variable validation
  5. Logic validation
  6. Negative testing (error handling)

### Dependencies
- **Prerequisites:** Stories 2.3 (session config), 2.4 (success criteria)
- **Blocks:** Story 2.6 (Phase 0 completion validation)
- **Informs:** Phase 1 readiness assessment

### Validation Approach
- **Positive Tests:** Configuration loads successfully with valid inputs
- **Negative Tests:** Configuration fails gracefully with clear error messages
- **Security Tests:** No hardcoded secrets present

### Expected Environment Variables
- `TAVILY_API_KEY`: Research capability (Phase 0)
- `AIRTABLE_API_KEY`: Data storage (Phase 1 Stage 4)
- `MAKE_API_KEY`: Automation workflows (Phase 1 Stage 5)
- `NETLIFY_API_TOKEN`: Deployment (Phase 1 Stage 6)
- `CLAUDE_API_KEY`: Content generation (Phase 1 Stage 5)

### Negative Test Purpose
Validates error handling for common configuration issues:
1. **Missing env var:** Tests credential validation
2. **Malformed YAML:** Tests parsing error reporting
3. **Invalid path:** Tests file validation

### Important Decisions
- Validation log is cumulative (append to existing log)
- Failed validation requires fix and re-test (no incomplete configs)
- Negative tests ensure graceful failure (no cryptic errors)
- Security scan is mandatory (no secrets in config)
- All validation results documented for Phase 1 handoff

### Testing

**Test Standards:**
- Manual configuration loading test
- YAML syntax validation
- Security scanning (grep for secrets)
- Negative test execution

**Validation Requirements:**
- Configuration loads without errors
- All required sections present
- File paths valid or documented as "will create"
- Environment variables use correct syntax
- No hardcoded secrets present
- Checkpoint logic reasonable
- Negative tests pass (graceful failures)
- Results documented in validation log
- Validation committed to Git

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-07 | 1.0 | Initial story creation from Epic 2 requirements | PM Agent (John) |

## Dev Agent Record

_(This section is owned by dev-agent and can only be modified by dev-agent)_

### Agent Model Used
_(This section will be populated by dev-agent during implementation)_

### Debug Log References
_(This section will be populated by dev-agent during implementation)_

### Completion Notes
_(This section will be populated by dev-agent during implementation)_

### File List
_(This section will be populated by dev-agent during implementation)_

## QA Results

_(This section is owned by qa-agent and can only be modified by qa-agent)_
